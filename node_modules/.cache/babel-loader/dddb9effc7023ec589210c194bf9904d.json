{"ast":null,"code":"const {\n  BN,\n  keccak,\n  keccak256,\n  rlphash,\n  zeros,\n  bufferToInt,\n  TWO_POW256\n} = require('ethereumjs-util');\n\nconst ethHashUtil = require('./util.js');\n\nconst xor = require('buffer-xor');\n\nconst async = require('async');\n\nvar Ethash = module.exports = function (cacheDB) {\n  this.dbOpts = {\n    valueEncoding: 'json'\n  };\n  this.cacheDB = cacheDB;\n  this.cache = false;\n};\n\nEthash.prototype.mkcache = function (cacheSize, seed) {\n  // console.log('generating cache')\n  // console.log('size: ' + cacheSize)\n  // console.log('seed: ' + seed.toString('hex'))\n  const n = Math.floor(cacheSize / ethHashUtil.params.HASH_BYTES);\n  var o = [keccak(seed, 512)];\n  var i;\n\n  for (i = 1; i < n; i++) {\n    o.push(keccak(o[o.length - 1], 512));\n  }\n\n  for (var _ = 0; _ < ethHashUtil.params.CACHE_ROUNDS; _++) {\n    for (i = 0; i < n; i++) {\n      var v = o[i].readUInt32LE(0) % n;\n      o[i] = keccak(xor(o[(i - 1 + n) % n], o[v]), 512);\n    }\n  }\n\n  this.cache = o;\n  return this.cache;\n};\n\nEthash.prototype.calcDatasetItem = function (i) {\n  const n = this.cache.length;\n  const r = Math.floor(ethHashUtil.params.HASH_BYTES / ethHashUtil.params.WORD_BYTES);\n  var mix = Buffer.from(this.cache[i % n]);\n  mix.writeInt32LE(mix.readUInt32LE(0) ^ i, 0);\n  mix = keccak(mix, 512);\n\n  for (var j = 0; j < ethHashUtil.params.DATASET_PARENTS; j++) {\n    var cacheIndex = ethHashUtil.fnv(i ^ j, mix.readUInt32LE(j % r * 4));\n    mix = ethHashUtil.fnvBuffer(mix, this.cache[cacheIndex % n]);\n  }\n\n  return keccak(mix, 512);\n};\n\nEthash.prototype.run = function (val, nonce, fullSize) {\n  fullSize = fullSize || this.fullSize;\n  const n = Math.floor(fullSize / ethHashUtil.params.HASH_BYTES);\n  const w = Math.floor(ethHashUtil.params.MIX_BYTES / ethHashUtil.params.WORD_BYTES);\n  const s = keccak(Buffer.concat([val, ethHashUtil.bufReverse(nonce)]), 512);\n  const mixhashes = Math.floor(ethHashUtil.params.MIX_BYTES / ethHashUtil.params.HASH_BYTES);\n  var mix = Buffer.concat(Array(mixhashes).fill(s));\n  var i;\n\n  for (i = 0; i < ethHashUtil.params.ACCESSES; i++) {\n    var p = ethHashUtil.fnv(i ^ s.readUInt32LE(0), mix.readUInt32LE(i % w * 4)) % Math.floor(n / mixhashes) * mixhashes;\n    var newdata = [];\n\n    for (var j = 0; j < mixhashes; j++) {\n      newdata.push(this.calcDatasetItem(p + j));\n    }\n\n    newdata = Buffer.concat(newdata);\n    mix = ethHashUtil.fnvBuffer(mix, newdata);\n  }\n\n  var cmix = Buffer.alloc(mix.length / 4);\n\n  for (i = 0; i < mix.length / 4; i = i + 4) {\n    var a = ethHashUtil.fnv(mix.readUInt32LE(i * 4), mix.readUInt32LE((i + 1) * 4));\n    var b = ethHashUtil.fnv(a, mix.readUInt32LE((i + 2) * 4));\n    var c = ethHashUtil.fnv(b, mix.readUInt32LE((i + 3) * 4));\n    cmix.writeUInt32LE(c, i);\n  }\n\n  return {\n    mix: cmix,\n    hash: keccak256(Buffer.concat([s, cmix]))\n  };\n};\n\nEthash.prototype.cacheHash = function () {\n  return keccak256(Buffer.concat(this.cache));\n};\n\nEthash.prototype.headerHash = function (header) {\n  return rlphash(header.slice(0, -2));\n};\n/**\n * Loads the seed and the cache given a block nnumber\n * @method loadEpoc\n * @param number Number\n * @param cm function\n */\n\n\nEthash.prototype.loadEpoc = function (number, cb) {\n  var self = this;\n  const epoc = ethHashUtil.getEpoc(number);\n\n  if (this.epoc === epoc) {\n    return cb();\n  }\n\n  this.epoc = epoc; // gives the seed the first epoc found\n\n  function findLastSeed(epoc, cb2) {\n    if (epoc === 0) {\n      return cb2(zeros(32), 0);\n    }\n\n    self.cacheDB.get(epoc, self.dbOpts, function (err, data) {\n      if (!err) {\n        cb2(data.seed, epoc);\n      } else {\n        findLastSeed(epoc - 1, cb2);\n      }\n    });\n  }\n  /* eslint-disable handle-callback-err */\n\n\n  self.cacheDB.get(epoc, self.dbOpts, function (err, data) {\n    if (!data) {\n      self.cacheSize = ethHashUtil.getCacheSize(epoc);\n      self.fullSize = ethHashUtil.getFullSize(epoc);\n      findLastSeed(epoc, function (seed, foundEpoc) {\n        self.seed = ethHashUtil.getSeed(seed, foundEpoc, epoc);\n        var cache = self.mkcache(self.cacheSize, self.seed); // store the generated cache\n\n        self.cacheDB.put(epoc, {\n          cacheSize: self.cacheSize,\n          fullSize: self.fullSize,\n          seed: self.seed,\n          cache: cache\n        }, self.dbOpts, cb);\n      });\n    } else {\n      // Object.assign(self, data)\n      self.cache = data.cache.map(function (a) {\n        return Buffer.from(a);\n      });\n      self.cacheSize = data.cacheSize;\n      self.fullSize = data.fullSize;\n      self.seed = Buffer.from(data.seed);\n      cb();\n    }\n  });\n  /* eslint-enable handle-callback-err */\n};\n\nEthash.prototype._verifyPOW = function (header, cb) {\n  var self = this;\n  var headerHash = this.headerHash(header.raw);\n  var number = bufferToInt(header.number);\n  this.loadEpoc(number, function () {\n    var a = self.run(headerHash, Buffer.from(header.nonce, 'hex'));\n    var result = new BN(a.hash);\n    /* eslint-disable standard/no-callback-literal */\n\n    cb(a.mix.toString('hex') === header.mixHash.toString('hex') && TWO_POW256.div(new BN(header.difficulty)).cmp(result) === 1);\n    /* eslint-enable standard/no-callback-literal */\n  });\n};\n\nEthash.prototype.verifyPOW = function (block, cb) {\n  var self = this;\n  var valid = true; // don't validate genesis blocks\n\n  if (block.header.isGenesis()) {\n    cb(true); // eslint-disable-line standard/no-callback-literal\n\n    return;\n  }\n\n  this._verifyPOW(block.header, function (valid2) {\n    valid &= valid2;\n\n    if (!valid) {\n      return cb(valid);\n    }\n\n    async.eachSeries(block.uncleHeaders, function (uheader, cb2) {\n      self._verifyPOW(uheader, function (valid3) {\n        valid &= valid3;\n\n        if (!valid) {\n          cb2(Boolean(valid));\n        } else {\n          cb2();\n        }\n      });\n    }, function () {\n      cb(Boolean(valid));\n    });\n  });\n};","map":{"version":3,"names":["BN","keccak","keccak256","rlphash","zeros","bufferToInt","TWO_POW256","require","ethHashUtil","xor","async","Ethash","module","exports","cacheDB","dbOpts","valueEncoding","cache","prototype","mkcache","cacheSize","seed","n","Math","floor","params","HASH_BYTES","o","i","push","length","_","CACHE_ROUNDS","v","readUInt32LE","calcDatasetItem","r","WORD_BYTES","mix","Buffer","from","writeInt32LE","j","DATASET_PARENTS","cacheIndex","fnv","fnvBuffer","run","val","nonce","fullSize","w","MIX_BYTES","s","concat","bufReverse","mixhashes","Array","fill","ACCESSES","p","newdata","cmix","alloc","a","b","c","writeUInt32LE","hash","cacheHash","headerHash","header","slice","loadEpoc","number","cb","self","epoc","getEpoc","findLastSeed","cb2","get","err","data","getCacheSize","getFullSize","foundEpoc","getSeed","put","map","_verifyPOW","raw","result","toString","mixHash","div","difficulty","cmp","verifyPOW","block","valid","isGenesis","valid2","eachSeries","uncleHeaders","uheader","valid3","Boolean"],"sources":["F:/Games/slotmachinereact/node_modules/ganache-core/node_modules/ethashjs/index.js"],"sourcesContent":["const {\n  BN,\n  keccak,\n  keccak256,\n  rlphash,\n  zeros,\n  bufferToInt,\n  TWO_POW256\n} = require('ethereumjs-util')\nconst ethHashUtil = require('./util.js')\nconst xor = require('buffer-xor')\nconst async = require('async')\n\nvar Ethash = (module.exports = function (cacheDB) {\n  this.dbOpts = {\n    valueEncoding: 'json'\n  }\n  this.cacheDB = cacheDB\n  this.cache = false\n})\n\nEthash.prototype.mkcache = function (cacheSize, seed) {\n  // console.log('generating cache')\n  // console.log('size: ' + cacheSize)\n  // console.log('seed: ' + seed.toString('hex'))\n  const n = Math.floor(cacheSize / ethHashUtil.params.HASH_BYTES)\n  var o = [keccak(seed, 512)]\n\n  var i\n  for (i = 1; i < n; i++) {\n    o.push(keccak(o[o.length - 1], 512))\n  }\n\n  for (var _ = 0; _ < ethHashUtil.params.CACHE_ROUNDS; _++) {\n    for (i = 0; i < n; i++) {\n      var v = o[i].readUInt32LE(0) % n\n      o[i] = keccak(xor(o[(i - 1 + n) % n], o[v]), 512)\n    }\n  }\n\n  this.cache = o\n  return this.cache\n}\n\nEthash.prototype.calcDatasetItem = function (i) {\n  const n = this.cache.length\n  const r = Math.floor(\n    ethHashUtil.params.HASH_BYTES / ethHashUtil.params.WORD_BYTES\n  )\n  var mix = Buffer.from(this.cache[i % n])\n  mix.writeInt32LE(mix.readUInt32LE(0) ^ i, 0)\n  mix = keccak(mix, 512)\n  for (var j = 0; j < ethHashUtil.params.DATASET_PARENTS; j++) {\n    var cacheIndex = ethHashUtil.fnv(i ^ j, mix.readUInt32LE((j % r) * 4))\n    mix = ethHashUtil.fnvBuffer(mix, this.cache[cacheIndex % n])\n  }\n  return keccak(mix, 512)\n}\n\nEthash.prototype.run = function (val, nonce, fullSize) {\n  fullSize = fullSize || this.fullSize\n  const n = Math.floor(fullSize / ethHashUtil.params.HASH_BYTES)\n  const w = Math.floor(\n    ethHashUtil.params.MIX_BYTES / ethHashUtil.params.WORD_BYTES\n  )\n  const s = keccak(Buffer.concat([val, ethHashUtil.bufReverse(nonce)]), 512)\n  const mixhashes = Math.floor(\n    ethHashUtil.params.MIX_BYTES / ethHashUtil.params.HASH_BYTES\n  )\n  var mix = Buffer.concat(Array(mixhashes).fill(s))\n\n  var i\n  for (i = 0; i < ethHashUtil.params.ACCESSES; i++) {\n    var p =\n      (ethHashUtil.fnv(i ^ s.readUInt32LE(0), mix.readUInt32LE((i % w) * 4)) %\n        Math.floor(n / mixhashes)) *\n      mixhashes\n    var newdata = []\n    for (var j = 0; j < mixhashes; j++) {\n      newdata.push(this.calcDatasetItem(p + j))\n    }\n\n    newdata = Buffer.concat(newdata)\n    mix = ethHashUtil.fnvBuffer(mix, newdata)\n  }\n\n  var cmix = Buffer.alloc(mix.length / 4)\n  for (i = 0; i < mix.length / 4; i = i + 4) {\n    var a = ethHashUtil.fnv(\n      mix.readUInt32LE(i * 4),\n      mix.readUInt32LE((i + 1) * 4)\n    )\n    var b = ethHashUtil.fnv(a, mix.readUInt32LE((i + 2) * 4))\n    var c = ethHashUtil.fnv(b, mix.readUInt32LE((i + 3) * 4))\n    cmix.writeUInt32LE(c, i)\n  }\n\n  return {\n    mix: cmix,\n    hash: keccak256(Buffer.concat([s, cmix]))\n  }\n}\n\nEthash.prototype.cacheHash = function () {\n  return keccak256(Buffer.concat(this.cache))\n}\n\nEthash.prototype.headerHash = function (header) {\n  return rlphash(header.slice(0, -2))\n}\n\n/**\n * Loads the seed and the cache given a block nnumber\n * @method loadEpoc\n * @param number Number\n * @param cm function\n */\nEthash.prototype.loadEpoc = function (number, cb) {\n  var self = this\n  const epoc = ethHashUtil.getEpoc(number)\n\n  if (this.epoc === epoc) {\n    return cb()\n  }\n\n  this.epoc = epoc\n\n  // gives the seed the first epoc found\n  function findLastSeed (epoc, cb2) {\n    if (epoc === 0) {\n      return cb2(zeros(32), 0)\n    }\n\n    self.cacheDB.get(epoc, self.dbOpts, function (err, data) {\n      if (!err) {\n        cb2(data.seed, epoc)\n      } else {\n        findLastSeed(epoc - 1, cb2)\n      }\n    })\n  }\n\n  /* eslint-disable handle-callback-err */\n  self.cacheDB.get(epoc, self.dbOpts, function (err, data) {\n    if (!data) {\n      self.cacheSize = ethHashUtil.getCacheSize(epoc)\n      self.fullSize = ethHashUtil.getFullSize(epoc)\n\n      findLastSeed(epoc, function (seed, foundEpoc) {\n        self.seed = ethHashUtil.getSeed(seed, foundEpoc, epoc)\n        var cache = self.mkcache(self.cacheSize, self.seed)\n        // store the generated cache\n        self.cacheDB.put(\n          epoc,\n          {\n            cacheSize: self.cacheSize,\n            fullSize: self.fullSize,\n            seed: self.seed,\n            cache: cache\n          },\n          self.dbOpts,\n          cb\n        )\n      })\n    } else {\n      // Object.assign(self, data)\n      self.cache = data.cache.map(function (a) {\n        return Buffer.from(a)\n      })\n      self.cacheSize = data.cacheSize\n      self.fullSize = data.fullSize\n      self.seed = Buffer.from(data.seed)\n      cb()\n    }\n  })\n  /* eslint-enable handle-callback-err */\n}\n\nEthash.prototype._verifyPOW = function (header, cb) {\n  var self = this\n  var headerHash = this.headerHash(header.raw)\n  var number = bufferToInt(header.number)\n\n  this.loadEpoc(number, function () {\n    var a = self.run(headerHash, Buffer.from(header.nonce, 'hex'))\n    var result = new BN(a.hash)\n    /* eslint-disable standard/no-callback-literal */\n    cb(\n      a.mix.toString('hex') === header.mixHash.toString('hex') &&\n        TWO_POW256.div(new BN(header.difficulty)).cmp(result) === 1\n    )\n    /* eslint-enable standard/no-callback-literal */\n  })\n}\n\nEthash.prototype.verifyPOW = function (block, cb) {\n  var self = this\n  var valid = true\n\n  // don't validate genesis blocks\n  if (block.header.isGenesis()) {\n    cb(true) // eslint-disable-line standard/no-callback-literal\n    return\n  }\n\n  this._verifyPOW(block.header, function (valid2) {\n    valid &= valid2\n\n    if (!valid) {\n      return cb(valid)\n    }\n\n    async.eachSeries(\n      block.uncleHeaders,\n      function (uheader, cb2) {\n        self._verifyPOW(uheader, function (valid3) {\n          valid &= valid3\n          if (!valid) {\n            cb2(Boolean(valid))\n          } else {\n            cb2()\n          }\n        })\n      },\n      function () {\n        cb(Boolean(valid))\n      }\n    )\n  })\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}