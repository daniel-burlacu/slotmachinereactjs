{"ast":null,"code":"/*\n This file is part of web3.js.\n\n web3.js is free software: you can redistribute it and/or modify\n it under the terms of the GNU Lesser General Public License as published by\n the Free Software Foundation, either version 3 of the License, or\n (at your option) any later version.\n\n web3.js is distributed in the hope that it will be useful,\n but WITHOUT ANY WARRANTY; without even the implied warranty of\n MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n GNU Lesser General Public License for more details.\n\n You should have received a copy of the GNU Lesser General Public License\n along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @file WebsocketProvider.js\n * @authors: Samuel Furter <samuel@ethereum.org>, Fabian Vogelsteller <fabian@ethereum.org>\n * @date 2019\n */\n'use strict';\n\nvar EventEmitter = require('eventemitter3');\n\nvar helpers = require('./helpers.js');\n\nvar errors = require('web3-core-helpers').errors;\n\nvar Ws = require('websocket').w3cwebsocket;\n/**\n * @param {string} url\n * @param {Object} options\n *\n * @constructor\n */\n\n\nvar WebsocketProvider = function WebsocketProvider(url, options) {\n  EventEmitter.call(this);\n  options = options || {};\n  this.url = url;\n  this._customTimeout = options.timeout || 1000 * 15;\n  this.headers = options.headers || {};\n  this.protocol = options.protocol || undefined;\n  this.reconnectOptions = Object.assign({\n    auto: false,\n    delay: 5000,\n    maxAttempts: false,\n    onTimeout: false\n  }, options.reconnect);\n  this.clientConfig = options.clientConfig || undefined; // Allow a custom client configuration\n\n  this.requestOptions = options.requestOptions || undefined; // Allow a custom request options (https://github.com/theturtle32/WebSocket-Node/blob/master/docs/WebSocketClient.md#connectrequesturl-requestedprotocols-origin-headers-requestoptions)\n\n  this.DATA = 'data';\n  this.CLOSE = 'close';\n  this.ERROR = 'error';\n  this.CONNECT = 'connect';\n  this.RECONNECT = 'reconnect';\n  this.connection = null;\n  this.requestQueue = new Map();\n  this.responseQueue = new Map();\n  this.reconnectAttempts = 0;\n  this.reconnecting = false; // The w3cwebsocket implementation does not support Basic Auth\n  // username/password in the URL. So generate the basic auth header, and\n  // pass through with any additional headers supplied in constructor\n\n  var parsedURL = helpers.parseURL(url);\n\n  if (parsedURL.username && parsedURL.password) {\n    this.headers.authorization = 'Basic ' + helpers.btoa(parsedURL.username + ':' + parsedURL.password);\n  } // When all node core implementations that do not have the\n  // WHATWG compatible URL parser go out of service this line can be removed.\n\n\n  if (parsedURL.auth) {\n    this.headers.authorization = 'Basic ' + helpers.btoa(parsedURL.auth);\n  } // make property `connected` which will return the current connection status\n\n\n  Object.defineProperty(this, 'connected', {\n    get: function () {\n      return this.connection && this.connection.readyState === this.connection.OPEN;\n    },\n    enumerable: true\n  });\n  this.connect();\n}; // Inherit from EventEmitter\n\n\nWebsocketProvider.prototype = Object.create(EventEmitter.prototype);\nWebsocketProvider.prototype.constructor = WebsocketProvider;\n/**\n * Connects to the configured node\n *\n * @method connect\n *\n * @returns {void}\n */\n\nWebsocketProvider.prototype.connect = function () {\n  this.connection = new Ws(this.url, this.protocol, undefined, this.headers, this.requestOptions, this.clientConfig);\n\n  this._addSocketListeners();\n};\n/**\n * Listener for the `data` event of the underlying WebSocket object\n *\n * @method _onMessage\n *\n * @returns {void}\n */\n\n\nWebsocketProvider.prototype._onMessage = function (e) {\n  var _this = this;\n\n  this._parseResponse(typeof e.data === 'string' ? e.data : '').forEach(function (result) {\n    if (result.method && result.method.indexOf('_subscription') !== -1) {\n      _this.emit(_this.DATA, result);\n\n      return;\n    }\n\n    var id = result.id; // get the id which matches the returned id\n\n    if (Array.isArray(result)) {\n      id = result[0].id;\n    }\n\n    if (_this.responseQueue.has(id)) {\n      if (_this.responseQueue.get(id).callback !== undefined) {\n        _this.responseQueue.get(id).callback(false, result);\n      }\n\n      _this.responseQueue.delete(id);\n    }\n  });\n};\n/**\n * Listener for the `open` event of the underlying WebSocket object\n *\n * @method _onConnect\n *\n * @returns {void}\n */\n\n\nWebsocketProvider.prototype._onConnect = function () {\n  this.emit(this.CONNECT);\n  this.reconnectAttempts = 0;\n  this.reconnecting = false;\n\n  if (this.requestQueue.size > 0) {\n    var _this = this;\n\n    this.requestQueue.forEach(function (request, key) {\n      _this.send(request.payload, request.callback);\n\n      _this.requestQueue.delete(key);\n    });\n  }\n};\n/**\n * Listener for the `close` event of the underlying WebSocket object\n *\n * @method _onClose\n *\n * @returns {void}\n */\n\n\nWebsocketProvider.prototype._onClose = function (event) {\n  var _this = this;\n\n  if (this.reconnectOptions.auto && (![1000, 1001].includes(event.code) || event.wasClean === false)) {\n    this.reconnect();\n    return;\n  }\n\n  this.emit(this.CLOSE, event);\n\n  if (this.requestQueue.size > 0) {\n    this.requestQueue.forEach(function (request, key) {\n      request.callback(errors.ConnectionNotOpenError(event));\n\n      _this.requestQueue.delete(key);\n    });\n  }\n\n  if (this.responseQueue.size > 0) {\n    this.responseQueue.forEach(function (request, key) {\n      request.callback(errors.InvalidConnection('on WS', event));\n\n      _this.responseQueue.delete(key);\n    });\n  }\n\n  this._removeSocketListeners();\n\n  this.removeAllListeners();\n};\n/**\n * Will add the required socket listeners\n *\n * @method _addSocketListeners\n *\n * @returns {void}\n */\n\n\nWebsocketProvider.prototype._addSocketListeners = function () {\n  this.connection.addEventListener('message', this._onMessage.bind(this));\n  this.connection.addEventListener('open', this._onConnect.bind(this));\n  this.connection.addEventListener('close', this._onClose.bind(this));\n};\n/**\n * Will remove all socket listeners\n *\n * @method _removeSocketListeners\n *\n * @returns {void}\n */\n\n\nWebsocketProvider.prototype._removeSocketListeners = function () {\n  this.connection.removeEventListener('message', this._onMessage);\n  this.connection.removeEventListener('open', this._onConnect);\n  this.connection.removeEventListener('close', this._onClose);\n};\n/**\n * Will parse the response and make an array out of it.\n *\n * @method _parseResponse\n *\n * @param {String} data\n *\n * @returns {Array}\n */\n\n\nWebsocketProvider.prototype._parseResponse = function (data) {\n  var _this = this,\n      returnValues = []; // DE-CHUNKER\n\n\n  var dechunkedData = data.replace(/\\}[\\n\\r]?\\{/g, '}|--|{') // }{\n  .replace(/\\}\\][\\n\\r]?\\[\\{/g, '}]|--|[{') // }][{\n  .replace(/\\}[\\n\\r]?\\[\\{/g, '}|--|[{') // }[{\n  .replace(/\\}\\][\\n\\r]?\\{/g, '}]|--|{') // }]{\n  .split('|--|');\n  dechunkedData.forEach(function (data) {\n    // prepend the last chunk\n    if (_this.lastChunk) data = _this.lastChunk + data;\n    var result = null;\n\n    try {\n      result = JSON.parse(data);\n    } catch (e) {\n      _this.lastChunk = data; // start timeout to cancel all requests\n\n      clearTimeout(_this.lastChunkTimeout);\n      _this.lastChunkTimeout = setTimeout(function () {\n        if (_this.reconnectOptions.auto && _this.reconnectOptions.onTimeout) {\n          _this.reconnect();\n\n          return;\n        }\n\n        _this.emit(_this.ERROR, errors.ConnectionTimeout(_this._customTimeout));\n\n        if (_this.requestQueue.size > 0) {\n          _this.requestQueue.forEach(function (request, key) {\n            request.callback(errors.ConnectionTimeout(_this._customTimeout));\n\n            _this.requestQueue.delete(key);\n          });\n        }\n      }, _this._customTimeout);\n      return;\n    } // cancel timeout and set chunk to null\n\n\n    clearTimeout(_this.lastChunkTimeout);\n    _this.lastChunk = null;\n    if (result) returnValues.push(result);\n  });\n  return returnValues;\n};\n/**\n * Does check if the provider is connecting and will add it to the queue or will send it directly\n *\n * @method send\n *\n * @param {Object} payload\n * @param {Function} callback\n *\n * @returns {void}\n */\n\n\nWebsocketProvider.prototype.send = function (payload, callback) {\n  var _this = this;\n\n  var id = payload.id;\n  var request = {\n    payload: payload,\n    callback: callback\n  };\n\n  if (Array.isArray(payload)) {\n    id = payload[0].id;\n  }\n\n  if (this.connection.readyState === this.connection.CONNECTING || this.reconnecting) {\n    this.requestQueue.set(id, request);\n    return;\n  }\n\n  if (this.connection.readyState !== this.connection.OPEN) {\n    this.requestQueue.delete(id);\n    this.emit(this.ERROR, errors.ConnectionNotOpenError());\n    request.callback(errors.ConnectionNotOpenError());\n    return;\n  }\n\n  this.responseQueue.set(id, request);\n  this.requestQueue.delete(id);\n\n  try {\n    this.connection.send(JSON.stringify(request.payload));\n  } catch (error) {\n    request.callback(error);\n\n    _this.responseQueue.delete(id);\n  }\n};\n/**\n * Resets the providers, clears all callbacks\n *\n * @method reset\n *\n * @returns {void}\n */\n\n\nWebsocketProvider.prototype.reset = function () {\n  this.responseQueue.clear();\n  this.requestQueue.clear();\n  this.removeAllListeners();\n\n  this._removeSocketListeners();\n\n  this._addSocketListeners();\n};\n/**\n * Closes the current connection with the given code and reason arguments\n *\n * @method disconnect\n *\n * @param {number} code\n * @param {string} reason\n *\n * @returns {void}\n */\n\n\nWebsocketProvider.prototype.disconnect = function (code, reason) {\n  this._removeSocketListeners();\n\n  this.connection.close(code || 1000, reason);\n};\n/**\n * Returns the desired boolean.\n *\n * @method supportsSubscriptions\n *\n * @returns {boolean}\n */\n\n\nWebsocketProvider.prototype.supportsSubscriptions = function () {\n  return true;\n};\n/**\n * Removes the listeners and reconnects to the socket.\n *\n * @method reconnect\n *\n * @returns {void}\n */\n\n\nWebsocketProvider.prototype.reconnect = function () {\n  var _this = this;\n\n  this.reconnecting = true;\n\n  if (this.responseQueue.size > 0) {\n    this.responseQueue.forEach(function (request, key) {\n      request.callback(errors.PendingRequestsOnReconnectingError());\n\n      _this.responseQueue.delete(key);\n    });\n  }\n\n  if (!this.reconnectOptions.maxAttempts || this.reconnectAttempts < this.reconnectOptions.maxAttempts) {\n    setTimeout(function () {\n      _this.reconnectAttempts++;\n\n      _this._removeSocketListeners();\n\n      _this.emit(_this.RECONNECT, _this.reconnectAttempts);\n\n      _this.connect();\n    }, this.reconnectOptions.delay);\n    return;\n  }\n\n  this.emit(this.ERROR, errors.MaxAttemptsReachedOnReconnectingError());\n  this.reconnecting = false;\n\n  if (this.requestQueue.size > 0) {\n    this.requestQueue.forEach(function (request, key) {\n      request.callback(errors.MaxAttemptsReachedOnReconnectingError());\n\n      _this.requestQueue.delete(key);\n    });\n  }\n};\n\nmodule.exports = WebsocketProvider;","map":{"version":3,"names":["EventEmitter","require","helpers","errors","Ws","w3cwebsocket","WebsocketProvider","url","options","call","_customTimeout","timeout","headers","protocol","undefined","reconnectOptions","Object","assign","auto","delay","maxAttempts","onTimeout","reconnect","clientConfig","requestOptions","DATA","CLOSE","ERROR","CONNECT","RECONNECT","connection","requestQueue","Map","responseQueue","reconnectAttempts","reconnecting","parsedURL","parseURL","username","password","authorization","btoa","auth","defineProperty","get","readyState","OPEN","enumerable","connect","prototype","create","constructor","_addSocketListeners","_onMessage","e","_this","_parseResponse","data","forEach","result","method","indexOf","emit","id","Array","isArray","has","callback","delete","_onConnect","size","request","key","send","payload","_onClose","event","includes","code","wasClean","ConnectionNotOpenError","InvalidConnection","_removeSocketListeners","removeAllListeners","addEventListener","bind","removeEventListener","returnValues","dechunkedData","replace","split","lastChunk","JSON","parse","clearTimeout","lastChunkTimeout","setTimeout","ConnectionTimeout","push","CONNECTING","set","stringify","error","reset","clear","disconnect","reason","close","supportsSubscriptions","PendingRequestsOnReconnectingError","MaxAttemptsReachedOnReconnectingError","module","exports"],"sources":["F:/Games/slotmachinereact/node_modules/ganache-core/node_modules/web3-providers-ws/src/index.js"],"sourcesContent":["/*\n This file is part of web3.js.\n\n web3.js is free software: you can redistribute it and/or modify\n it under the terms of the GNU Lesser General Public License as published by\n the Free Software Foundation, either version 3 of the License, or\n (at your option) any later version.\n\n web3.js is distributed in the hope that it will be useful,\n but WITHOUT ANY WARRANTY; without even the implied warranty of\n MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n GNU Lesser General Public License for more details.\n\n You should have received a copy of the GNU Lesser General Public License\n along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @file WebsocketProvider.js\n * @authors: Samuel Furter <samuel@ethereum.org>, Fabian Vogelsteller <fabian@ethereum.org>\n * @date 2019\n */\n\n'use strict';\n\nvar EventEmitter = require('eventemitter3');\nvar helpers = require('./helpers.js');\nvar errors = require('web3-core-helpers').errors;\nvar Ws = require('websocket').w3cwebsocket;\n\n/**\n * @param {string} url\n * @param {Object} options\n *\n * @constructor\n */\nvar WebsocketProvider = function WebsocketProvider(url, options) {\n    EventEmitter.call(this);\n\n    options = options || {};\n    this.url = url;\n    this._customTimeout = options.timeout || 1000 * 15;\n    this.headers = options.headers || {};\n    this.protocol = options.protocol || undefined;\n    this.reconnectOptions = Object.assign({\n            auto: false,\n            delay: 5000,\n            maxAttempts: false,\n            onTimeout: false\n        },\n        options.reconnect\n    );\n    this.clientConfig = options.clientConfig || undefined; // Allow a custom client configuration\n    this.requestOptions = options.requestOptions || undefined; // Allow a custom request options (https://github.com/theturtle32/WebSocket-Node/blob/master/docs/WebSocketClient.md#connectrequesturl-requestedprotocols-origin-headers-requestoptions)\n\n    this.DATA = 'data';\n    this.CLOSE = 'close';\n    this.ERROR = 'error';\n    this.CONNECT = 'connect';\n    this.RECONNECT = 'reconnect';\n\n    this.connection = null;\n    this.requestQueue = new Map();\n    this.responseQueue = new Map();\n    this.reconnectAttempts = 0;\n    this.reconnecting = false;\n\n    // The w3cwebsocket implementation does not support Basic Auth\n    // username/password in the URL. So generate the basic auth header, and\n    // pass through with any additional headers supplied in constructor\n    var parsedURL = helpers.parseURL(url);\n    if (parsedURL.username && parsedURL.password) {\n        this.headers.authorization = 'Basic ' + helpers.btoa(parsedURL.username + ':' + parsedURL.password);\n    }\n\n    // When all node core implementations that do not have the\n    // WHATWG compatible URL parser go out of service this line can be removed.\n    if (parsedURL.auth) {\n        this.headers.authorization = 'Basic ' + helpers.btoa(parsedURL.auth);\n    }\n\n    // make property `connected` which will return the current connection status\n    Object.defineProperty(this, 'connected', {\n        get: function () {\n            return this.connection && this.connection.readyState === this.connection.OPEN;\n        },\n        enumerable: true\n    });\n\n    this.connect();\n};\n\n// Inherit from EventEmitter\nWebsocketProvider.prototype = Object.create(EventEmitter.prototype);\nWebsocketProvider.prototype.constructor = WebsocketProvider;\n\n/**\n * Connects to the configured node\n *\n * @method connect\n *\n * @returns {void}\n */\nWebsocketProvider.prototype.connect = function () {\n    this.connection = new Ws(this.url, this.protocol, undefined, this.headers, this.requestOptions, this.clientConfig);\n    this._addSocketListeners();\n};\n\n/**\n * Listener for the `data` event of the underlying WebSocket object\n *\n * @method _onMessage\n *\n * @returns {void}\n */\nWebsocketProvider.prototype._onMessage = function (e) {\n    var _this = this;\n\n    this._parseResponse((typeof e.data === 'string') ? e.data : '').forEach(function (result) {\n        if (result.method && result.method.indexOf('_subscription') !== -1) {\n            _this.emit(_this.DATA, result);\n\n            return;\n        }\n\n        var id = result.id;\n\n        // get the id which matches the returned id\n        if (Array.isArray(result)) {\n            id = result[0].id;\n        }\n\n        if (_this.responseQueue.has(id)) {\n            if(_this.responseQueue.get(id).callback !== undefined) {\n                _this.responseQueue.get(id).callback(false, result);\n            }\n            _this.responseQueue.delete(id);\n        }\n    });\n};\n\n/**\n * Listener for the `open` event of the underlying WebSocket object\n *\n * @method _onConnect\n *\n * @returns {void}\n */\nWebsocketProvider.prototype._onConnect = function () {\n    this.emit(this.CONNECT);\n    this.reconnectAttempts = 0;\n    this.reconnecting = false;\n\n    if (this.requestQueue.size > 0) {\n        var _this = this;\n\n        this.requestQueue.forEach(function (request, key) {\n            _this.send(request.payload, request.callback);\n            _this.requestQueue.delete(key);\n        });\n    }\n};\n\n/**\n * Listener for the `close` event of the underlying WebSocket object\n *\n * @method _onClose\n *\n * @returns {void}\n */\nWebsocketProvider.prototype._onClose = function (event) {\n    var _this = this;\n\n    if (this.reconnectOptions.auto && (![1000, 1001].includes(event.code) || event.wasClean === false)) {\n        this.reconnect();\n\n        return;\n    }\n\n    this.emit(this.CLOSE, event);\n\n    if (this.requestQueue.size > 0) {\n        this.requestQueue.forEach(function (request, key) {\n            request.callback(errors.ConnectionNotOpenError(event));\n            _this.requestQueue.delete(key);\n        });\n    }\n\n    if (this.responseQueue.size > 0) {\n        this.responseQueue.forEach(function (request, key) {\n            request.callback(errors.InvalidConnection('on WS', event));\n            _this.responseQueue.delete(key);\n        });\n    }\n\n    this._removeSocketListeners();\n    this.removeAllListeners();\n};\n\n/**\n * Will add the required socket listeners\n *\n * @method _addSocketListeners\n *\n * @returns {void}\n */\nWebsocketProvider.prototype._addSocketListeners = function () {\n    this.connection.addEventListener('message', this._onMessage.bind(this));\n    this.connection.addEventListener('open', this._onConnect.bind(this));\n    this.connection.addEventListener('close', this._onClose.bind(this));\n};\n\n/**\n * Will remove all socket listeners\n *\n * @method _removeSocketListeners\n *\n * @returns {void}\n */\nWebsocketProvider.prototype._removeSocketListeners = function () {\n    this.connection.removeEventListener('message', this._onMessage);\n    this.connection.removeEventListener('open', this._onConnect);\n    this.connection.removeEventListener('close', this._onClose);\n};\n\n/**\n * Will parse the response and make an array out of it.\n *\n * @method _parseResponse\n *\n * @param {String} data\n *\n * @returns {Array}\n */\nWebsocketProvider.prototype._parseResponse = function (data) {\n    var _this = this,\n        returnValues = [];\n\n    // DE-CHUNKER\n    var dechunkedData = data\n        .replace(/\\}[\\n\\r]?\\{/g, '}|--|{') // }{\n        .replace(/\\}\\][\\n\\r]?\\[\\{/g, '}]|--|[{') // }][{\n        .replace(/\\}[\\n\\r]?\\[\\{/g, '}|--|[{') // }[{\n        .replace(/\\}\\][\\n\\r]?\\{/g, '}]|--|{') // }]{\n        .split('|--|');\n\n    dechunkedData.forEach(function (data) {\n\n        // prepend the last chunk\n        if (_this.lastChunk)\n            data = _this.lastChunk + data;\n\n        var result = null;\n\n        try {\n            result = JSON.parse(data);\n        } catch (e) {\n\n            _this.lastChunk = data;\n\n            // start timeout to cancel all requests\n            clearTimeout(_this.lastChunkTimeout);\n            _this.lastChunkTimeout = setTimeout(function () {\n                if (_this.reconnectOptions.auto && _this.reconnectOptions.onTimeout) {\n                    _this.reconnect();\n\n                    return;\n                }\n\n\n                _this.emit(_this.ERROR, errors.ConnectionTimeout(_this._customTimeout));\n\n                if (_this.requestQueue.size > 0) {\n                    _this.requestQueue.forEach(function (request, key) {\n                        request.callback(errors.ConnectionTimeout(_this._customTimeout));\n                        _this.requestQueue.delete(key);\n                    });\n                }\n            }, _this._customTimeout);\n\n            return;\n        }\n\n        // cancel timeout and set chunk to null\n        clearTimeout(_this.lastChunkTimeout);\n        _this.lastChunk = null;\n\n        if (result)\n            returnValues.push(result);\n    });\n\n    return returnValues;\n};\n\n/**\n * Does check if the provider is connecting and will add it to the queue or will send it directly\n *\n * @method send\n *\n * @param {Object} payload\n * @param {Function} callback\n *\n * @returns {void}\n */\nWebsocketProvider.prototype.send = function (payload, callback) {\n    var _this = this;\n    var id = payload.id;\n    var request = {payload: payload, callback: callback};\n\n    if (Array.isArray(payload)) {\n        id = payload[0].id;\n    }\n\n    if (this.connection.readyState === this.connection.CONNECTING || this.reconnecting) {\n        this.requestQueue.set(id, request);\n\n        return;\n    }\n\n    if (this.connection.readyState !== this.connection.OPEN) {\n        this.requestQueue.delete(id);\n\n        this.emit(this.ERROR, errors.ConnectionNotOpenError());\n        request.callback(errors.ConnectionNotOpenError());\n\n        return;\n    }\n\n    this.responseQueue.set(id, request);\n    this.requestQueue.delete(id);\n\n    try {\n        this.connection.send(JSON.stringify(request.payload));\n    } catch (error) {\n        request.callback(error);\n        _this.responseQueue.delete(id);\n    }\n};\n\n/**\n * Resets the providers, clears all callbacks\n *\n * @method reset\n *\n * @returns {void}\n */\nWebsocketProvider.prototype.reset = function () {\n    this.responseQueue.clear();\n    this.requestQueue.clear();\n\n    this.removeAllListeners();\n\n    this._removeSocketListeners();\n    this._addSocketListeners();\n};\n\n/**\n * Closes the current connection with the given code and reason arguments\n *\n * @method disconnect\n *\n * @param {number} code\n * @param {string} reason\n *\n * @returns {void}\n */\nWebsocketProvider.prototype.disconnect = function (code, reason) {\n    this._removeSocketListeners();\n    this.connection.close(code || 1000, reason);\n};\n\n/**\n * Returns the desired boolean.\n *\n * @method supportsSubscriptions\n *\n * @returns {boolean}\n */\nWebsocketProvider.prototype.supportsSubscriptions = function () {\n    return true;\n};\n\n/**\n * Removes the listeners and reconnects to the socket.\n *\n * @method reconnect\n *\n * @returns {void}\n */\nWebsocketProvider.prototype.reconnect = function () {\n    var _this = this;\n    this.reconnecting = true;\n\n    if (this.responseQueue.size > 0) {\n        this.responseQueue.forEach(function (request, key) {\n            request.callback(errors.PendingRequestsOnReconnectingError());\n            _this.responseQueue.delete(key);\n        });\n    }\n\n    if (\n        !this.reconnectOptions.maxAttempts ||\n        this.reconnectAttempts < this.reconnectOptions.maxAttempts\n    ) {\n        setTimeout(function () {\n            _this.reconnectAttempts++;\n            _this._removeSocketListeners();\n            _this.emit(_this.RECONNECT, _this.reconnectAttempts);\n            _this.connect();\n        }, this.reconnectOptions.delay);\n\n        return;\n    }\n\n    this.emit(this.ERROR, errors.MaxAttemptsReachedOnReconnectingError());\n    this.reconnecting = false;\n\n    if (this.requestQueue.size > 0) {\n        this.requestQueue.forEach(function (request, key) {\n            request.callback(errors.MaxAttemptsReachedOnReconnectingError());\n            _this.requestQueue.delete(key);\n        });\n    }\n};\n\nmodule.exports = WebsocketProvider;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}