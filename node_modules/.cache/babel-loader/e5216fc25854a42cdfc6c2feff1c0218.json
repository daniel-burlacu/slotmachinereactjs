{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar BN = require(\"bn.js\");\n\nvar ethereumjs_util_1 = require(\"ethereumjs-util\");\n\nvar _a = require('../exceptions'),\n    ERROR = _a.ERROR,\n    VmError = _a.VmError;\n/**\n * Implementation of the stack used in evm.\n */\n\n\nvar Stack =\n/** @class */\nfunction () {\n  function Stack() {\n    this._store = [];\n  }\n\n  Object.defineProperty(Stack.prototype, \"length\", {\n    get: function () {\n      return this._store.length;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Stack.prototype.push = function (value) {\n    if (!BN.isBN(value)) {\n      throw new VmError(ERROR.INTERNAL_ERROR);\n    }\n\n    if (value.gt(ethereumjs_util_1.MAX_INTEGER)) {\n      throw new VmError(ERROR.OUT_OF_RANGE);\n    }\n\n    if (this._store.length > 1023) {\n      throw new VmError(ERROR.STACK_OVERFLOW);\n    }\n\n    this._store.push(value);\n  };\n\n  Stack.prototype.pop = function () {\n    if (this._store.length < 1) {\n      throw new VmError(ERROR.STACK_UNDERFLOW);\n    } // Length is checked above, so pop shouldn't return undefined\n\n\n    return this._store.pop();\n  };\n  /**\n   * Pop multiple items from stack. Top of stack is first item\n   * in returned array.\n   * @param num - Number of items to pop\n   */\n\n\n  Stack.prototype.popN = function (num) {\n    if (num === void 0) {\n      num = 1;\n    }\n\n    if (this._store.length < num) {\n      throw new VmError(ERROR.STACK_UNDERFLOW);\n    }\n\n    if (num === 0) {\n      return [];\n    }\n\n    return this._store.splice(-1 * num).reverse();\n  };\n  /**\n   * Swap top of stack with an item in the stack.\n   * @param position - Index of item from top of the stack (0-indexed)\n   */\n\n\n  Stack.prototype.swap = function (position) {\n    if (this._store.length <= position) {\n      throw new VmError(ERROR.STACK_UNDERFLOW);\n    }\n\n    var head = this._store.length - 1;\n    var i = this._store.length - position - 1;\n    var tmp = this._store[head];\n    this._store[head] = this._store[i];\n    this._store[i] = tmp;\n  };\n  /**\n   * Pushes a copy of an item in the stack.\n   * @param position - Index of item to be copied (1-indexed)\n   */\n\n\n  Stack.prototype.dup = function (position) {\n    if (this._store.length < position) {\n      throw new VmError(ERROR.STACK_UNDERFLOW);\n    }\n\n    var i = this._store.length - position;\n    this.push(this._store[i].clone());\n  };\n\n  return Stack;\n}();\n\nexports.default = Stack;","map":{"version":3,"mappings":";;;;;;AAAA;;AACA;;AACM;AAAA,IAAEA,gBAAF;AAAA,IAASC,oBAAT;AAEN;;;;;AAGA;AAAA;AAAA;EAGE;IACE,KAAKC,MAAL,GAAc,EAAd;EACD;;EAEDC,sBAAIC,eAAJ,EAAI,QAAJ,EAAU;SAAV;MACE,OAAO,KAAKF,MAAL,CAAYG,MAAnB;IACD,CAFS;oBAAA;;EAAA,CAAV;;EAIAD,iCAAKE,KAAL,EAAc;IACZ,IAAI,CAACC,EAAE,CAACC,IAAH,CAAQF,KAAR,CAAL,EAAqB;MACnB,MAAM,IAAIL,OAAJ,CAAYD,KAAK,CAACS,cAAlB,CAAN;IACD;;IAED,IAAIH,KAAK,CAACI,EAAN,CAASC,6BAAT,CAAJ,EAA2B;MACzB,MAAM,IAAIV,OAAJ,CAAYD,KAAK,CAACY,YAAlB,CAAN;IACD;;IAED,IAAI,KAAKV,MAAL,CAAYG,MAAZ,GAAqB,IAAzB,EAA+B;MAC7B,MAAM,IAAIJ,OAAJ,CAAYD,KAAK,CAACa,cAAlB,CAAN;IACD;;IAED,KAAKX,MAAL,CAAYY,IAAZ,CAAiBR,KAAjB;EACD,CAdD;;EAgBAF;IACE,IAAI,KAAKF,MAAL,CAAYG,MAAZ,GAAqB,CAAzB,EAA4B;MAC1B,MAAM,IAAIJ,OAAJ,CAAYD,KAAK,CAACe,eAAlB,CAAN;IACD,CAHH,CAKE;;;IACA,OAAO,KAAKb,MAAL,CAAYc,GAAZ,EAAP;EACD,CAPD;EASA;;;;;;;EAKAZ,iCAAKa,GAAL,EAAoB;IAAf;MAAAA;IAAe;;IAClB,IAAI,KAAKf,MAAL,CAAYG,MAAZ,GAAqBY,GAAzB,EAA8B;MAC5B,MAAM,IAAIhB,OAAJ,CAAYD,KAAK,CAACe,eAAlB,CAAN;IACD;;IAED,IAAIE,GAAG,KAAK,CAAZ,EAAe;MACb,OAAO,EAAP;IACD;;IAED,OAAO,KAAKf,MAAL,CAAYgB,MAAZ,CAAmB,CAAC,CAAD,GAAKD,GAAxB,EAA6BE,OAA7B,EAAP;EACD,CAVD;EAYA;;;;;;EAIAf,iCAAKgB,QAAL,EAAqB;IACnB,IAAI,KAAKlB,MAAL,CAAYG,MAAZ,IAAsBe,QAA1B,EAAoC;MAClC,MAAM,IAAInB,OAAJ,CAAYD,KAAK,CAACe,eAAlB,CAAN;IACD;;IAED,IAAMM,IAAI,GAAG,KAAKnB,MAAL,CAAYG,MAAZ,GAAqB,CAAlC;IACA,IAAMiB,CAAC,GAAG,KAAKpB,MAAL,CAAYG,MAAZ,GAAqBe,QAArB,GAAgC,CAA1C;IAEA,IAAMG,GAAG,GAAG,KAAKrB,MAAL,CAAYmB,IAAZ,CAAZ;IACA,KAAKnB,MAAL,CAAYmB,IAAZ,IAAoB,KAAKnB,MAAL,CAAYoB,CAAZ,CAApB;IACA,KAAKpB,MAAL,CAAYoB,CAAZ,IAAiBC,GAAjB;EACD,CAXD;EAaA;;;;;;EAIAnB,gCAAIgB,QAAJ,EAAoB;IAClB,IAAI,KAAKlB,MAAL,CAAYG,MAAZ,GAAqBe,QAAzB,EAAmC;MACjC,MAAM,IAAInB,OAAJ,CAAYD,KAAK,CAACe,eAAlB,CAAN;IACD;;IAED,IAAMO,CAAC,GAAG,KAAKpB,MAAL,CAAYG,MAAZ,GAAqBe,QAA/B;IACA,KAAKN,IAAL,CAAU,KAAKZ,MAAL,CAAYoB,CAAZ,EAAeE,KAAf,EAAV;EACD,CAPD;;EAQF;AAAC,CAlFD","names":["ERROR","VmError","_store","Object","Stack","length","value","BN","isBN","INTERNAL_ERROR","gt","ethereumjs_util_1","OUT_OF_RANGE","STACK_OVERFLOW","push","STACK_UNDERFLOW","pop","num","splice","reverse","position","head","i","tmp","clone"],"sources":["../../lib/evm/stack.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}