{"ast":null,"code":"var LevelUpArrayAdapter = require(\"./database/leveluparrayadapter\");\n\nvar LevelUpObjectAdapter = require(\"./database/levelupobjectadapter\");\n\nvar levelup = require(\"levelup\");\n\nvar encode = require(\"encoding-down\");\n\nvar filedown = require(\"./database/filedown\");\n\nvar cachedown = require(\"cachedown\");\n\nvar txserializer = require(\"./database/txserializer\");\n\nvar blockserializer = require(\"./database/blockserializer\");\n\nvar bufferserializer = require(\"./database/bufferserializer\");\n\nvar BlockLogsSerializer = require(\"./database/blocklogsserializer\");\n\nvar ReceiptSerializer = require(\"./database/receiptserializer\");\n\nvar tmp = require(\"tmp\");\n\nfunction Database(options) {\n  this.options = options;\n  this.directory = null;\n}\n\nDatabase.prototype.initialize = function (callback) {\n  var self = this;\n\n  function getDir(cb) {\n    if (self.options.db_path) {\n      cb(null, self.options.db_path);\n    } else {\n      tmp.dir(cb);\n    }\n  }\n\n  getDir(function (err, directory) {\n    if (err) {\n      return callback(err);\n    }\n\n    const levelupOptions = {\n      valueEncoding: \"json\"\n    };\n\n    if (self.options.db) {\n      const store = self.options.db;\n      levelup(store, levelupOptions, finishInitializing);\n    } else {\n      self.directory = directory;\n      const store = encode(cachedown(directory, filedown).maxSize(100), levelupOptions);\n      levelup(store, {}, finishInitializing);\n    }\n  });\n\n  function finishInitializing(err, db) {\n    if (err) {\n      return callback(err);\n    }\n\n    self.db = db; // Blocks, keyed by array index (not necessarily by block number) (0-based)\n\n    self.blocks = new LevelUpArrayAdapter(\"blocks\", self.db, blockserializer); // Logs triggered in each block, keyed by block id (ids in the blocks array; not necessarily block number) (0-based)\n\n    self.blockLogs = new LevelUpArrayAdapter(\"blockLogs\", self.db, new BlockLogsSerializer(self)); // Block hashes -> block ids (ids in the blocks array; not necessarily block number) for quick lookup\n\n    self.blockHashes = new LevelUpObjectAdapter(\"blockHashes\", self.db); // Transaction hash -> transaction objects\n\n    self.transactions = new LevelUpObjectAdapter(\"transactions\", self.db, txserializer); // Transaction hash -> transaction receipts\n\n    self.transactionReceipts = new LevelUpObjectAdapter(\"transactionReceipts\", self.db, new ReceiptSerializer(self));\n    self.trie_db = new LevelUpObjectAdapter(\"trie_db\", self.db, bufferserializer, bufferserializer);\n    callback();\n  }\n};\n\nDatabase.prototype.close = function (callback) {\n  callback();\n};\n\nmodule.exports = Database;","map":{"version":3,"names":["LevelUpArrayAdapter","require","LevelUpObjectAdapter","levelup","encode","filedown","cachedown","txserializer","blockserializer","bufferserializer","BlockLogsSerializer","ReceiptSerializer","tmp","Database","options","directory","prototype","initialize","callback","self","getDir","cb","db_path","dir","err","levelupOptions","valueEncoding","db","store","finishInitializing","maxSize","blocks","blockLogs","blockHashes","transactions","transactionReceipts","trie_db","close","module","exports"],"sources":["F:/Games/slotmachinereact/node_modules/ganache-core/lib/database.js"],"sourcesContent":["var LevelUpArrayAdapter = require(\"./database/leveluparrayadapter\");\nvar LevelUpObjectAdapter = require(\"./database/levelupobjectadapter\");\nvar levelup = require(\"levelup\");\nvar encode = require(\"encoding-down\");\nvar filedown = require(\"./database/filedown\");\nvar cachedown = require(\"cachedown\");\nvar txserializer = require(\"./database/txserializer\");\nvar blockserializer = require(\"./database/blockserializer\");\nvar bufferserializer = require(\"./database/bufferserializer\");\nvar BlockLogsSerializer = require(\"./database/blocklogsserializer\");\nvar ReceiptSerializer = require(\"./database/receiptserializer\");\nvar tmp = require(\"tmp\");\n\nfunction Database(options) {\n  this.options = options;\n  this.directory = null;\n}\n\nDatabase.prototype.initialize = function(callback) {\n  var self = this;\n\n  function getDir(cb) {\n    if (self.options.db_path) {\n      cb(null, self.options.db_path);\n    } else {\n      tmp.dir(cb);\n    }\n  }\n\n  getDir(function(err, directory) {\n    if (err) {\n      return callback(err);\n    }\n    const levelupOptions = { valueEncoding: \"json\" };\n    if (self.options.db) {\n      const store = self.options.db;\n      levelup(store, levelupOptions, finishInitializing);\n    } else {\n      self.directory = directory;\n      const store = encode(cachedown(directory, filedown).maxSize(100), levelupOptions);\n      levelup(store, {}, finishInitializing);\n    }\n  });\n\n  function finishInitializing(err, db) {\n    if (err) {\n      return callback(err);\n    }\n\n    self.db = db;\n\n    // Blocks, keyed by array index (not necessarily by block number) (0-based)\n    self.blocks = new LevelUpArrayAdapter(\"blocks\", self.db, blockserializer);\n\n    // Logs triggered in each block, keyed by block id (ids in the blocks array; not necessarily block number) (0-based)\n    self.blockLogs = new LevelUpArrayAdapter(\"blockLogs\", self.db, new BlockLogsSerializer(self));\n\n    // Block hashes -> block ids (ids in the blocks array; not necessarily block number) for quick lookup\n    self.blockHashes = new LevelUpObjectAdapter(\"blockHashes\", self.db);\n\n    // Transaction hash -> transaction objects\n    self.transactions = new LevelUpObjectAdapter(\"transactions\", self.db, txserializer);\n\n    // Transaction hash -> transaction receipts\n    self.transactionReceipts = new LevelUpObjectAdapter(\"transactionReceipts\", self.db, new ReceiptSerializer(self));\n\n    self.trie_db = new LevelUpObjectAdapter(\"trie_db\", self.db, bufferserializer, bufferserializer);\n\n    callback();\n  }\n};\n\nDatabase.prototype.close = function(callback) {\n  callback();\n};\n\nmodule.exports = Database;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}