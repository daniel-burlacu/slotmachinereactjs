{"ast":null,"code":"var Sublevel = require(\"level-sublevel\");\n\nconst {\n  LevelUpOutOfRangeError,\n  BlockOutOfRangeError\n} = require(\"../utils/errorhelper\"); // Level up adapter that looks like an array. Doesn't support inserts.\n\n\nfunction LevelUpArrayAdapter(name, db, serializer) {\n  this.db = Sublevel(db);\n  this.db = this.db.sublevel(name);\n  this.name = name;\n  this.serializer = serializer || {\n    encode: function (val, callback) {\n      callback(null, val);\n    },\n    decode: function (val, callback) {\n      callback(null, val);\n    }\n  };\n}\n\nLevelUpArrayAdapter.prototype.length = function (callback) {\n  this.db.get(\"length\", function (err, result) {\n    if (err) {\n      if (err.notFound) {\n        return callback(null, 0);\n      } else {\n        return callback(err);\n      }\n    }\n\n    callback(null, result);\n  });\n};\n\nLevelUpArrayAdapter.prototype._get = function (key, callback) {\n  var self = this;\n  this.db.get(key, function (err, val) {\n    if (err) {\n      return callback(err);\n    }\n\n    self.serializer.decode(val, callback);\n  });\n};\n\nLevelUpArrayAdapter.prototype._put = function (key, value, callback) {\n  var self = this;\n  this.serializer.encode(value, function (err, encoded) {\n    if (err) {\n      return callback(err);\n    }\n\n    self.db.put(key, encoded, callback);\n  });\n};\n\nLevelUpArrayAdapter.prototype.get = function (index, callback) {\n  var self = this;\n  this.length(function (err, length) {\n    if (err) {\n      return callback(err);\n    }\n\n    if (index >= length) {\n      // index out of range\n      const RangeError = self.name === \"blocks\" ? new BlockOutOfRangeError(index, length) : new LevelUpOutOfRangeError(self.name, index, length);\n      return callback(RangeError);\n    }\n\n    self._get(index, callback);\n  });\n};\n\nLevelUpArrayAdapter.prototype.push = function (val, callback) {\n  var self = this;\n  this.length(function (err, length) {\n    if (err) {\n      return callback(err);\n    } // TODO: Do this in atomic batch.\n\n\n    self._put(length + \"\", val, function (err) {\n      if (err) {\n        return callback(err);\n      }\n\n      self.db.put(\"length\", length + 1, callback);\n    });\n  });\n};\n\nLevelUpArrayAdapter.prototype.pop = function (callback) {\n  var self = this;\n  this.length(function (err, length) {\n    if (err) {\n      return callback(err);\n    }\n\n    var newLength = length - 1; // TODO: Do this in atomic batch.\n\n    self._get(newLength + \"\", function (err, val) {\n      if (err) {\n        return callback(err);\n      }\n\n      self.db.del(newLength + \"\", function (err) {\n        if (err) {\n          return callback(err);\n        }\n\n        self.db.put(\"length\", newLength, function (err) {\n          if (err) {\n            return callback(err);\n          }\n\n          callback(null, val);\n        });\n      });\n    });\n  });\n};\n\nLevelUpArrayAdapter.prototype.last = function (callback) {\n  var self = this;\n  this.length(function (err, length) {\n    if (err) {\n      return callback(err);\n    }\n\n    if (length === 0) {\n      return callback(null, null);\n    }\n\n    self._get(length - 1 + \"\", callback);\n  });\n};\n\nLevelUpArrayAdapter.prototype.first = function (callback) {\n  this._get(\"0\", callback);\n};\n\nmodule.exports = LevelUpArrayAdapter;","map":{"version":3,"names":["Sublevel","require","LevelUpOutOfRangeError","BlockOutOfRangeError","LevelUpArrayAdapter","name","db","serializer","sublevel","encode","val","callback","decode","prototype","length","get","err","result","notFound","_get","key","self","_put","value","encoded","put","index","RangeError","push","pop","newLength","del","last","first","module","exports"],"sources":["F:/Games/slotmachinereact/node_modules/ganache-core/lib/database/leveluparrayadapter.js"],"sourcesContent":["var Sublevel = require(\"level-sublevel\");\nconst { LevelUpOutOfRangeError, BlockOutOfRangeError } = require(\"../utils/errorhelper\");\n\n// Level up adapter that looks like an array. Doesn't support inserts.\n\nfunction LevelUpArrayAdapter(name, db, serializer) {\n  this.db = Sublevel(db);\n  this.db = this.db.sublevel(name);\n  this.name = name;\n  this.serializer = serializer || {\n    encode: function(val, callback) {\n      callback(null, val);\n    },\n    decode: function(val, callback) {\n      callback(null, val);\n    }\n  };\n}\n\nLevelUpArrayAdapter.prototype.length = function(callback) {\n  this.db.get(\"length\", function(err, result) {\n    if (err) {\n      if (err.notFound) {\n        return callback(null, 0);\n      } else {\n        return callback(err);\n      }\n    }\n\n    callback(null, result);\n  });\n};\n\nLevelUpArrayAdapter.prototype._get = function(key, callback) {\n  var self = this;\n  this.db.get(key, function(err, val) {\n    if (err) {\n      return callback(err);\n    }\n    self.serializer.decode(val, callback);\n  });\n};\n\nLevelUpArrayAdapter.prototype._put = function(key, value, callback) {\n  var self = this;\n  this.serializer.encode(value, function(err, encoded) {\n    if (err) {\n      return callback(err);\n    }\n    self.db.put(key, encoded, callback);\n  });\n};\n\nLevelUpArrayAdapter.prototype.get = function(index, callback) {\n  var self = this;\n\n  this.length(function(err, length) {\n    if (err) {\n      return callback(err);\n    }\n    if (index >= length) {\n      // index out of range\n      const RangeError =\n        self.name === \"blocks\"\n          ? new BlockOutOfRangeError(index, length)\n          : new LevelUpOutOfRangeError(self.name, index, length);\n      return callback(RangeError);\n    }\n    self._get(index, callback);\n  });\n};\n\nLevelUpArrayAdapter.prototype.push = function(val, callback) {\n  var self = this;\n  this.length(function(err, length) {\n    if (err) {\n      return callback(err);\n    }\n\n    // TODO: Do this in atomic batch.\n    self._put(length + \"\", val, function(err) {\n      if (err) {\n        return callback(err);\n      }\n      self.db.put(\"length\", length + 1, callback);\n    });\n  });\n};\n\nLevelUpArrayAdapter.prototype.pop = function(callback) {\n  var self = this;\n\n  this.length(function(err, length) {\n    if (err) {\n      return callback(err);\n    }\n\n    var newLength = length - 1;\n\n    // TODO: Do this in atomic batch.\n    self._get(newLength + \"\", function(err, val) {\n      if (err) {\n        return callback(err);\n      }\n      self.db.del(newLength + \"\", function(err) {\n        if (err) {\n          return callback(err);\n        }\n        self.db.put(\"length\", newLength, function(err) {\n          if (err) {\n            return callback(err);\n          }\n\n          callback(null, val);\n        });\n      });\n    });\n  });\n};\n\nLevelUpArrayAdapter.prototype.last = function(callback) {\n  var self = this;\n  this.length(function(err, length) {\n    if (err) {\n      return callback(err);\n    }\n\n    if (length === 0) {\n      return callback(null, null);\n    }\n\n    self._get(length - 1 + \"\", callback);\n  });\n};\n\nLevelUpArrayAdapter.prototype.first = function(callback) {\n  this._get(\"0\", callback);\n};\n\nmodule.exports = LevelUpArrayAdapter;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}